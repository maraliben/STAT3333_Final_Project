---
title: "STAT3333_Final_projectrmd"
author: "Marali Benitez, Kelly Thackeray, Lance John"
date: "2025-11-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(broom)
library(infer)   # for permutation/bootstrap tests
library(patchwork)   # for side-by-side plots
library(testequavar)
```

##                              Technology Useage & Stress Wellness

**Abstract**\
As technology advances and society’s dependence on it deepens, there is growing worry that excessive use of technology can negatively impact users’ stress levels. In fact, the American Psychological Association found that high attachment levels to devices and the constant use of technology is associated with higher stress levels, and about a fifth of Americans identify the use of technology as a significant source of stress (American Psychological Association, 2017). As such, looking at the relationship between technology usage and stress can be extremely important in understanding how technology can negatively impact stress levels for its users. \
\
**Problem**\
As stated previously, it has been found that technology usage can negatively affect stress levels for its users. Multiple factors other than technology can also influence stress and wellness, including but not limited to age, gender, and physical activity levels (Idrees, Blal et al). Understanding what factors affect stress levels can help mitigate or control stress levels and improve personal wellness.\
\
**Purpose**\
The purpose of this project is to determine if stress levels differ significantly by gender or age group, if screen time is correlated with mental health scores, if stress and physical activity are independent, and if regression models can predict stress levels based on tech use. Understanding how tech use impacts wellness can inform healthier digital habits and public health strategies. \
\
**The Dataset**\
The dataset used in this project was sourced from Kaggle and was made available on Kaggle by Nagpal Prabhavalkar. The dataset contains information on 5,000 participants and 25 variables. The variables are as follows: the user id of the participant, the age of the participant, the participant’s gender, daily screen time (in hours), daily phone usage (in hours), daily laptop usage (in hours), daily tablet usage (in hours), daily tv usage (in hours), daily social media usage (in hours), daily work related technology usage (in hours), entertainment hours, gaming hours, sleep duration (in hours), sleep quality (rated on a scale of 1 to 5), mood rating (rated on a scale of 1 to 10), stress level (rated on a scale of 1 to 10), physical activity (in hours per week), location type (rated as rural, suburban, or urban), mental health score (rated on a scale of 1 to 100), if the participant uses wellness apps (true or false), if the participant eats healthy (true or false), caffeine intake (in milligrams per day), weekly anxiety score (rated from 0 to 20), weekly depression score (from 0 to 20) and the participant’s mindfulness score (in minutes per day).\
\
The variables that will be focused on in this project will be gender, age, daily screen time, stress level, mental health score, physical activity, mood rating, sleep quality, and location type. It is important to note that categories like stress level, mental health score, mood rating, and sleep quality are subjective, and there may not be consistency in how participants answer or respond to these categories.\

This project analyzes the relationship between technology usage (daily screen time, phone usage) and wellness outcomes (stress level, mental health score, sleep quality).
We investigate differences across age groups, genders, and location types.\
Research Questions:\
• 	Do stress levels differ significantly by gender or age group?\
• 	Is screen time correlated with mental health scores?\
• 	Are stress and physical activity independent?\
• 	Can regression models predict stress from tech use?\
Relevance: Understanding how tech use impacts wellness can inform healthier digital habits and public health strategies.

```{r}
# Load the data
data <- read.csv("Tech_Use_Stress_Wellness.csv")
# Exploratory Data Analysis
#View(data)
#str(data)
#glimpse(data)
#summary(data)
ggplot(data, aes(x = daily_screen_time_hours)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "white") +
  labs(title = "Distribution of Daily Screen Time")
```

```{r}

# Daily screen time by gender
ggplot(data, aes(x = daily_screen_time_hours, fill = gender)) + labs(title = "Daily Screen Time per Gender", x = "Daily Screen Time (hours)", y = "Count per Gender" ) + geom_histogram() + theme_minimal()

# Correlation between daily screen time and stress level
ggplot(data, aes(x = daily_screen_time_hours, y = stress_level, color = gender)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Screen Time vs Stress by Gender",
       x = "Daily Screen Time (hours)",
       y = "Stress Level") + theme_minimal()

# Distribution of Screen Time and Physical Activity
ggplot(data, aes(x = daily_screen_time_hours)) +
  geom_histogram(binwidth = 1, fill = "steelblue", color = "white") +
  labs(title = "Distribution of Daily Screen Time",
       x = "Daily Screen Time (hours)",
       y = "Count") +
  theme_minimal()

ggplot(data, aes(x = physical_activity_hours_per_week)) +
  geom_histogram(binwidth = 1, fill = "darkgreen", color = "white") +
  labs(title = "Distribution of Weekly Physical Activity",
       x = "Physical Activity (hours per week)",
       y = "Count") +
  theme_minimal()


# Wellness
ggplot(data, aes(x = daily_screen_time_hours, y = mental_health_score)) +
  geom_point(alpha = 0.6, color = "steelblue", size = 2) +   # softer points
  geom_smooth(method = "lm", se = TRUE, color = "darkred", linetype = "dashed", size = 1.2) +
  labs(
    title = "Daily Screen Time vs Mental Health Score",
    x = "Daily Screen Time (hours)",
    y = "Mental Health Score") + theme_minimal() 



# Summary statistics
data %>%
  group_by(gender) %>%
  summarise(mean_stress = mean(stress_level, na.rm = TRUE),
            mean_wellness = mean(mental_health_score, na.rm = TRUE))
data %>%
  group_by(location_type) %>%
  summarise(mean_stress = mean(stress_level, na.rm = TRUE),
            mean_wellness = mean(mental_health_score, na.rm = TRUE))
data %>%
  group_by(age) %>%
  summarise(mean_stress = mean(stress_level, na.rm = TRUE),
            mean_wellness = mean(mental_health_score, na.rm = TRUE))
# Mean daily screen time by location type
data %>%
  group_by(location_type) %>%
  summarise(mean_screen_time = mean(daily_screen_time_hours, na.rm = TRUE))
```


```{r}
# Compare CI for stress levels across gender/age groups.
# CI for mean stress level using ggpltot2 and infer package
boot_dist <- data %>%
  specify(response = stress_level) %>%
  generate(reps = 1000, type = "bootstrap") %>%
  calculate(stat = "mean")

boot_ci <- boot_dist %>%
  get_ci(level = 0.95, type = "percentile")
boot_ci

# Manual Bootstrap for mean stress level from Chap05Bootstrap.Rmd Chihara, L., & Hesterberg, T. (2019). Mathematical Statistics with Resampling and R.
x <- data$stress_level
n <- length(x)
N <-  10^4

data.mean<-numeric(N)
#set.seed(2025)
for (i in 1:N)
{
   boot_sample <- sample(x, n, replace = TRUE)
   data.mean[i] <- mean(boot_sample)
}

# Check normality
hist(data.mean, main = "Bootstrap distribution of means")
abline(v = mean(data.mean), col = "blue", lty = 2)
qqnorm(data.mean)
qqline(data.mean)

#bootstrap mean
mean(data.mean) 
#bootstrap standard error or std dev of the boot means
sd(data.mean) 
# 95% boot percentile CI
quantile(data.mean, c(0.025, 0.975)) 

```

```{r}
# Hypothesis test
# Example: Is mean stress > 8?
t.test(data$stress_level, mu = 8, alternative = "greater")

# Compare stress by gender standard t.test insufficient due to 3 factors - use pairwise t.test
pairwise.t.test(data$stress_level, data$gender, p.adjust.method = "bonferroni")
```

```{r}
# Correlation matrix for key numeric variables
numeric_vars <- data %>%
  select(stress_level,
         daily_screen_time_hours,
         mental_health_score,
         physical_activity_hours_per_week)

cor_matrix <- cor(numeric_vars, use = "complete.obs")

cor_matrix

# One-sample CI and hypothesis test for mean stress level
mean_stress <- mean(data$stress_level, na.rm = TRUE)
sd_stress   <- sd(data$stress_level, na.rm = TRUE)
n_stress    <- sum(!is.na(data$stress_level))

# 95% CI for population mean stress
se_stress <- sd_stress / sqrt(n_stress)
lower_ci  <- mean_stress - 1.96 * se_stress
upper_ci  <- mean_stress + 1.96 * se_stress
c(lower_ci = lower_ci, upper_ci = upper_ci)

# One-sample t-test: is mean stress > 5?
t.test(data$stress_level, mu = 5, alternative = "greater")

```

```{r}
# Correlation between activity and stress
cor.test(data$physical_activity, data$stress_level)

# Linear regression: stress ~ screen time
lm_model <- lm(stress_level ~ daily_screen_time_hours, data = data)
summary(lm_model)

# Plot regression
ggplot(data, aes(x = daily_screen_time_hours, y = stress_level)) +
  geom_point(alpha = 0.6, color = "steelblue") +
  geom_smooth(method = "lm", se = TRUE, color = "darkred", linetype = "dashed") +
  labs(title = "Screen Time vs Stress Level")+ theme_minimal()

```

```{r}
# Simple linear regression: mental health ~ screen time
lm_mh_screen <- lm(mental_health_score ~ daily_screen_time_hours, data = data)
summary(lm_mh_screen)

# 95% CI for the screen-time slope
confint(lm_mh_screen, parm = "daily_screen_time_hours", level = 0.95)

```

```{r}
# Simple linear regression: stress ~ physical activity
lm_stress_activity <- lm(stress_level ~ physical_activity_hours_per_week, data = data)
summary(lm_stress_activity)

# 95% CI for the physical-activity slope
confint(lm_stress_activity,
        parm = "physical_activity_hours_per_week",
        level = 0.95)
```

```{r}
# Simple linear regression: stress ~ mental health score
lm_stress_mh <- lm(stress_level ~ mental_health_score, data = data)
summary(lm_stress_mh)

# 95% CI for the slope (effect of mental health on stress)
confint(lm_stress_mh, parm = "mental_health_score", level = 0.95)

```

```{r}
# ANOVA: stress by age group
data$age_group <- cut(
  data$age,
  breaks = c(0, 25, 40, 60, 80, 100),
  labels = c("≤25", "26-40", "41-60", "61-80", "81+"),
  right = TRUE
)

anova_age <- aov(stress_level ~ age_group, data = data)
summary(anova_age)

# Diagnostics: Q-Q plot
plot(anova_age, which = 2)

# Permutation ANOVA for robustness
set.seed(2025)
observed <- anova(lm(stress_level ~ age_group, data = data))$`F value`[1]
N <- 1000
results <- numeric(N)
for (i in 1:N) {
  index <- sample(seq_along(data$stress_level))
  stress_perm <- data$stress_level[index]
  results[i] <- anova(lm(stress_perm ~ age_group, data = data))$`F value`[1]
}
perm_p <- (sum(results >= observed) + 1) / (N + 1)
perm_p

# Post-hoc Tukey HSD
TukeyHSD(anova_age)

# Plots side by side
p1 <- ggplot(data, aes(x = age_group, y = stress_level)) +
  geom_boxplot(fill = "lightblue") +
  labs(title = "Stress Level by Age Group") + theme_minimal()

p2 <- ggplot(data, aes(x = age_group, y = daily_screen_time_hours)) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "darkgreen") +
  labs(title = "Daily Screen Time by Age Group") + theme_minimal()

p1 + p2
```

Stress by Age Group\
A one-way ANOVA was conducted to examine differences in stress levels across age groups. One group (81+) had no observations, so the analysis effectively compared four age groups (≤25, 26–40, 41–60, 61–80). The ANOVA indicated a strong overall effect of age group on stress, F(3, 4996) = 576.8, p < 0.001.\
Tukey post-hoc comparisons showed that the youngest group (≤25) reported substantially higher mean stress than all older groups (differences ≈ 3–4.4 units on the stress scale, all p < 0.001). Stress decreased with age: 26–40 had lower stress than ≤25, 41–60 lower than 26–40, and 61–80 had the lowest stress levels overall.\
A permutation ANOVA yielded a very small p-value (≈ 0.001), consistent with the classical ANOVA and reinforcing that age-related differences in stress are highly unlikely to be due to chance. Visualizations of stress and daily screen time by age group suggested that younger adults both reported higher screen time and higher stress, pointing to a potential link between intensive tech use and stress in younger participants.\

```{r}
# ANOVA: stress by location type
anova_loc <- aov(stress_level ~ location_type, data = data)
summary(anova_loc)

# Diagnostics
plot(anova_loc, which = 2)

# Permutation ANOVA
set.seed(2025)
observed <- anova(lm(stress_level ~ location_type, data = data))$`F value`[1]
N <- 1000
results <- numeric(N)
for (i in 1:N) {
  index <- sample(seq_along(data$stress_level))
  stress_perm <- data$stress_level[index]
  results[i] <- anova(lm(stress_perm ~ location_type, data = data))$`F value`[1]
}
perm_p <- (sum(results >= observed) + 1) / (N + 1)
perm_p

# Post-hoc Tukey HSD
TukeyHSD(anova_loc)

# Plots side by side
p3 <- ggplot(data, aes(x = location_type, y = stress_level)) +
  geom_boxplot(fill = "lightblue") +
  labs(title = "Stress Level by Location") + theme_minimal()

p4 <- ggplot(data, aes(x = location_type, y = daily_screen_time_hours)) +
  geom_jitter(width = 0.2, alpha = 0.5, color = "darkgreen") +
  labs(title = "Daily Screen Time by Location") + theme_minimal()

p3 + p4
```
Stress by Location Type\
A one-way ANOVA compared mean stress levels across location types (Urban, Suburban, Rural). The overall effect of location was not statistically significant, F(2, 4997) = 2.27, p = 0.10. A permutation ANOVA produced a similar p-value (≈ 0.13), indicating that any observed differences in mean stress by location could plausibly be due to random variation.\
Tukey post-hoc comparisons showed that the estimated mean stress in urban areas was slightly higher than in rural and suburban areas, but all confidence intervals included zero and all adjusted p-values exceeded 0.10, so no pairwise differences met conventional significance thresholds.\
Boxplots and jittered scatterplots suggest a small trend toward higher stress and higher screen time in urban participants, but given the non-significant test results, these patterns should be interpreted cautiously as suggestive rather than conclusive.\

```{r}
# Chi-square test for independence of mood and sleep quality
tab <- table(data$mood_rating, data$sleep_quality)
chisq.test(tab)
chi <- chisq.test(tab)
#chi$stdres
# Identify cells with large standardized residuals
thr <- 3
idx <- which(chi$stdres > thr, arr.ind = TRUE)

cbind(
  mood_rating  = rownames(chi$stdres)[idx[,"row"]],
  sleep_quality = colnames(chi$stdres)[idx[,"col"]],
  std_residual = chi$stdres[idx]
)
```

```{r}
# Bin mood ratings into categories
data$mood_cat <- cut(data$mood_rating,
                     breaks = c(0, 3, 7, 10),
                     labels = c("Low", "Medium", "High"),
                     include.lowest = TRUE)

# Drop rows with missing values
clean_df <- na.omit(data[, c("mood_cat", "sleep_quality")])

# Force both variables to be factors with explicit levels
clean_df$mood_cat <- factor(clean_df$mood_cat,
                            levels = c("Low", "Medium", "High"))

clean_df$sleep_quality <- factor(clean_df$sleep_quality,
                                 levels = c("1","2","3","4","5"))

# Build contingency table
tab <- table(clean_df$mood_cat, clean_df$sleep_quality)

library(knitr)

# Convert to data frame for kable
df_tab <- as.data.frame.matrix(tab)

# Create kable
kable(df_tab, caption = "Contingency Table of Mood Category by Sleep Quality",
      align = "c")
```

Independence of Mood and Sleep Quality\
A chi‑square test of independence was performed to assess the relationship between mood ratings and sleep quality. Results indicated a statistically significant association, suggesting that individuals with poorer sleep quality tended to report lower mood ratings. Standardized residuals revealed that the strongest contributions to the chi-square statistic came from participants with very low mood ratings (≈1–2) combined with poor sleep quality (ratings of 1–3), where residuals exceeded thresholds of 9–14. This suggests that individuals reporting poor sleep were disproportionately likely to also report very low mood. Conversely, participants with high mood ratings (≈7.5–10) paired with excellent sleep quality (rating = 5) also showed large positive residuals (≈3–7.5), indicating that good sleep was strongly associated with higher mood scores.\

```{r}
# Bootstrap CI for mean stress level
# Manual bootstrap from Chap05Bootstrap.Rmd
x <- data$stress_level
n <- length(x)
N <- 1000
data.mean <- numeric(N)

for (i in 1:N) {
  boot_sample <- sample(x, n, replace = TRUE)
  data.mean[i] <- mean(boot_sample)
}

mean(data.mean)
sd(data.mean)
quantile(data.mean, c(0.025, 0.975))

# Compare to parametric t-CI
t.test(x)$conf.int
```
Bootstrap vs Parametric Confidence Intervals\
To evaluate robustness of mean stress estimates, both parametric t‑based confidence intervals and bootstrap percentile intervals were computed. The parametric 95% CI for mean stress was narrow and centered around the sample mean. The bootstrap percentile CI closely matched, with only minor differences in bounds. This agreement suggests that parametric assumptions were reasonable in this dataset, but the bootstrap method provided reassurance that conclusions remain valid even under potential non‑normality or outliers. Together, these analyses demonstrate that stress levels vary meaningfully across demographic groups, that mood and sleep are interrelated, and that bootstrap methods can validate parametric inference.\

Conclusion\
This study investigated how technology use relates to stress and broader wellness outcomes through ANOVA, chi-square tests, correlation, regression, and bootstrap methods. Consistent with prior concerns about technology and stress, we found that stress levels differed significantly across age groups, with younger participants (≤25) reporting the highest stress and stress decreasing steadily with age. Gender differences were minimal, and location type (Urban, Suburban, Rural) showed no statistically significant effects, though urban participants displayed a small, non-significant trend toward higher stress and screen time.
Regression analyses demonstrated that daily screen time was a strong positive predictor of stress, while physical activity was strongly negatively correlated with stress, underscoring the role of lifestyle factors in wellness. Mood and sleep quality were also closely linked: chi-square tests revealed that poor sleep was disproportionately associated with very low mood, while excellent sleep aligned with high mood ratings. Bootstrap confidence intervals for mean stress closely matched parametric t-based intervals, reinforcing the robustness of the findings. Overall, these results support the abstract’s premise that technology use can negatively impact stress and wellness, particularly among younger adults, while also showing that wellness indicators such as sleep, mood, and physical activity are interrelated. The findings suggest that healthier digital habits, combined with lifestyle interventions, may help mitigate stress and promote better overall wellness.\

Insights:\
• Stress varies substantially across age, with younger adults (≤25) reporting the highest levels and older groups reporting lower stress.\
• Mood and sleep quality are strongly associated, consistent with the idea that sleep and emotional wellbeing are intertwined.\
• Bootstrap methods produced confidence intervals that closely matched parametric t-intervals, increasing confidence in the stability of the stress estimates.\

Limitations:\
• 	Data are self‑reported, which may introduce bias or measurement error.\
• 	The study is observational, limiting causal inference.\
• 	Unequal group sizes and potential confounders (e.g., occupation, health status) may influence results.\


References
• 	Kaggle Dataset: Tech Use & Stress Wellness.\
• 	Chihara, L., & Hesterberg, T. (2019). Mathematical Statistics with Resampling and R.\
• 	American Psychological Association (2017). Stress in America: Coping with Change Stress in America™ Survey.\